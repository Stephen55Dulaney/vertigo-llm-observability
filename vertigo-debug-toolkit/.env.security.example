# Security Configuration for Vertigo Debug Toolkit
# Copy this file to .env and customize the values

# =============================================================================
# CORE SECURITY
# =============================================================================

# Flask Secret Key (used for sessions, CSRF, etc.)
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
FLASK_SECRET_KEY=your-super-secret-key-here

# JWT Secret Key for API token authentication
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
JWT_SECRET_KEY=your-jwt-secret-key-here

# Fernet Encryption Key for sensitive data encryption
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
FERNET_KEY=your-fernet-key-here

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis URL for rate limiting (falls back to memory if unavailable)
REDIS_URL=redis://localhost:6379/0

# Alternative Redis configuration
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_DB=0
# REDIS_PASSWORD=your-redis-password

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# Allowed origins for CORS (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:8080,http://localhost:5000,https://your-domain.com

# =============================================================================
# DATABASE SECURITY
# =============================================================================

# Database URL with encryption
DATABASE_URL=sqlite:///vertigo_debug.db

# For PostgreSQL with SSL:
# DATABASE_URL=postgresql://user:password@host:port/database?sslmode=require

# For MySQL with SSL:
# DATABASE_URL=mysql://user:password@host:port/database?ssl=true

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================

# Enable/disable rate limiting
ENABLE_RATE_LIMITING=true

# Rate limit tiers (requests per hour / per minute)
# Free tier limits
RATE_LIMIT_FREE_HOUR=100
RATE_LIMIT_FREE_MINUTE=10

# Premium tier limits
RATE_LIMIT_PREMIUM_HOUR=500
RATE_LIMIT_PREMIUM_MINUTE=50

# Admin tier limits
RATE_LIMIT_ADMIN_HOUR=2000
RATE_LIMIT_ADMIN_MINUTE=100

# =============================================================================
# AUTHENTICATION SECURITY
# =============================================================================

# Password requirements
MIN_PASSWORD_LENGTH=12
REQUIRE_UPPERCASE=true
REQUIRE_LOWERCASE=true
REQUIRE_DIGITS=true
REQUIRE_SPECIAL_CHARS=true
PASSWORD_MAX_AGE_DAYS=90

# Account lockout settings
MAX_FAILED_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=15

# Session configuration
SESSION_TIMEOUT_MINUTES=60
REMEMBER_ME_DURATION_DAYS=30

# =============================================================================
# SECURITY MONITORING
# =============================================================================

# Enable/disable security monitoring
ENABLE_SECURITY_MONITORING=true

# Detection thresholds
FAILED_LOGIN_THRESHOLD=5
BRUTE_FORCE_THRESHOLD=10
SUSPICIOUS_IP_THRESHOLD=20
RATE_VIOLATION_THRESHOLD=3

# Data retention (in days)
SECURITY_DATA_RETENTION_DAYS=30
CRITICAL_EVENT_RETENTION_DAYS=90

# Alert settings
ENABLE_SECURITY_ALERTS=true
ALERT_EMAIL=admin@your-domain.com
ALERT_WEBHOOK_URL=https://hooks.slack.com/your-webhook-url

# =============================================================================
# API SECURITY
# =============================================================================

# API key settings
API_KEY_EXPIRY_DAYS=30
DEFAULT_API_KEY_TIER=free

# API rate limiting
API_RATE_LIMIT_ENABLED=true
API_BURST_LIMIT=20

# =============================================================================
# CONTENT SECURITY
# =============================================================================

# Content Security Policy settings
CSP_ENABLED=true
CSP_REPORT_URI=/security/csp-report

# File upload security
MAX_FILE_SIZE_MB=10
ALLOWED_FILE_EXTENSIONS=.txt,.json,.csv,.log,.md

# Request size limits
MAX_REQUEST_SIZE_MB=16
MAX_JSON_SIZE_KB=1024
MAX_FORM_FIELDS=50

# =============================================================================
# SSL/TLS CONFIGURATION
# =============================================================================

# Force HTTPS in production
FORCE_HTTPS=false

# HSTS settings
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=false

# =============================================================================
# LOGGING AND MONITORING
# =============================================================================

# Security logging
SECURITY_LOG_LEVEL=INFO
SECURITY_LOG_FILE=/var/log/vertigo/security.log

# Enable detailed request logging
LOG_SECURITY_EVENTS=true
LOG_FAILED_LOGINS=true
LOG_RATE_LIMIT_VIOLATIONS=true

# =============================================================================
# PRODUCTION SECURITY SETTINGS
# =============================================================================

# Environment type (affects security settings)
FLASK_ENV=development
# Set to 'production' for production deployment

# Debug mode (NEVER enable in production)
FLASK_DEBUG=false

# Enable/disable development features
DEV_API_KEY_IN_QUERY=false  # Allow API keys in query parameters (dev only)
DEV_CORS_ALLOW_ALL=false    # Allow all CORS origins (dev only)
DEV_DISABLE_CSRF=false      # Disable CSRF protection (dev only)

# =============================================================================
# INTEGRATION SETTINGS
# =============================================================================

# Langfuse configuration (existing)
LANGFUSE_PUBLIC_KEY=your-langfuse-public-key
LANGFUSE_SECRET_KEY=your-langfuse-secret-key
LANGFUSE_HOST=http://localhost:3000

# Google Cloud settings (existing)
GOOGLE_CLOUD_PROJECT=your-project-id
GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json

# =============================================================================
# ADVANCED SECURITY FEATURES
# =============================================================================

# IP Geolocation (for anomaly detection)
ENABLE_IP_GEOLOCATION=false
GEOLOCATION_API_KEY=your-geolocation-api-key

# Threat Intelligence
ENABLE_THREAT_INTEL=false
THREAT_INTEL_API_KEY=your-threat-intel-api-key

# WAF Integration
ENABLE_WAF_INTEGRATION=false
WAF_API_ENDPOINT=https://your-waf-api.com

# =============================================================================
# BACKUP AND RECOVERY
# =============================================================================

# Backup encryption
BACKUP_ENCRYPTION_KEY=your-backup-encryption-key

# Recovery settings
ENABLE_DISASTER_RECOVERY=false
DR_BACKUP_LOCATION=/secure/backup/location

# =============================================================================
# COMPLIANCE SETTINGS
# =============================================================================

# GDPR compliance
ENABLE_GDPR_MODE=false
DATA_RETENTION_POLICY_DAYS=365

# SOC2 compliance
ENABLE_SOC2_LOGGING=false
AUDIT_LOG_RETENTION_YEARS=7

# =============================================================================
# NOTES
# =============================================================================

# 1. Never commit this file with real secrets to version control
# 2. Use environment-specific values for different deployments
# 3. Regularly rotate secrets and API keys
# 4. Monitor logs for security events
# 5. Keep all dependencies updated
# 6. Conduct regular security audits
# 7. Have an incident response plan ready

# For production deployment:
# - Use strong, unique secrets
# - Enable HTTPS/SSL
# - Configure proper CORS origins  
# - Set up monitoring and alerting
# - Use production-grade Redis instance
# - Configure proper database security
# - Enable comprehensive logging